# LottoNumber 조건 추가 가이드

## 목적
LottoNumber 프로젝트에 새로운 필터 조건을 추가하는 과정을 단계별로 정리했습니다. 아래 절차를 따르면 UI에 별도 수동 등록 없이 조건 목록이 자동으로 확장됩니다.

## 사전 준비
- 개발 환경: Visual Studio 2019 이상 (.NET Framework 4.8)
- 솔루션 루트: D:\004. Lotto\LottoNumber
- 주요 경로
  - 조건 클래스: Conditions/
  - 뷰모델: ViewModels/MainWindowViewModel.cs
  - 동적 탐색: Conditions/ICondition.cs 의 ConditionDiscovery

## 구현 순서
1. **조건 클래스 생성**
   - Conditions/ 폴더에 <새조건명>Condition.cs 파일을 추가합니다.
   - ICondition 인터페이스를 구현하고 sealed 클래스로 선언합니다.

   `csharp
   public sealed class SumWithinRangeCondition : ICondition
   {
       public string Key => "SumWithinRange";
       public string DisplayName => "합계가 범위 내";
       public string Description => "지정한 최소/최대 합계 안에 있는 조합만 남깁니다.";
   }
   `

2. **ParameterSpec 정의**
   - 입력이 필요한 경우 ParameterSpecs 속성에 ParameterSpec 배열을 반환합니다.
   - Name 은 내부적으로 사용되는 키, Label 은 UI 레이블, DefaultValue 는 초기값입니다.

   `csharp
   public IReadOnlyList<ParameterSpec> ParameterSpecs => new[]
   {
       new ParameterSpec("MIN", "최솟값", "90"),
       new ParameterSpec("MAX", "최댓값", "210")
   };
   `

3. **Evaluate 로직 작성**
   - combo(6개 숫자)와 parameters 사전을 사용해 필터링 조건을 구현합니다.
   - 	rue 를 반환하면 해당 조합이 **제외** 됩니다.

   `csharp
   public bool Evaluate(int[] combo, IDictionary<string, string> parameters = null)
   {
       if (combo == null || combo.Length != 6)
           throw new ArgumentException("combo must be a 6-number array");

       int min = 90, max = 210;
       if (parameters != null)
       {
           if (parameters.TryGetValue("MIN", out var minText)) int.TryParse(minText, out min);
           if (parameters.TryGetValue("MAX", out var maxText)) int.TryParse(maxText, out max);
       }

       int sum = combo.Sum();
       return sum < min || sum > max;
   }
   `

4. **자동 등록 확인**
   - ConditionDiscovery 가 동일 어셈블리의 ICondition 구현체를 반영합니다.
   - 클래스 파일을 추가하고 빌드하면 MainWindowViewModel 의 ConditionOptions 컬렉션에 자동으로 포함됩니다.

5. **UI 검증**
   - 빌드 후 in/Debug/LottoNumber.exe 실행
   - 좌측 조건 콤보박스에서 새 조건이 표시되는지 확인
   - 파라미터 레이블/기본값이 의도대로 출력되는지 검증

6. **테스트**
   - ApplyFilters 버튼으로 필터를 실행해 동작을 확인합니다.
   - 필요 시 ExportFilteredCsv 를 통해 결과를 CSV 로 내보내 검증할 수 있습니다.

## 권장 팁
- DisplayName 과 Description 은 한국어로 작성해 UI 가독성을 높입니다.
- Evaluate 내에서 parameters 값 검증을 수행해 잘못된 입력에 대한 예외를 방지합니다.
- 복잡한 조건은 별도 헬퍼 메서드로 분리해 유지보수를 쉽게 합니다.
- 변경 후 msbuild LottoNumber.sln /t:Build /p:Configuration=Debug 명령으로 컴파일 오류를 확인하세요.

---
필요하다면 이 문서를 PPT로 옮길 때, 슬라이드 제목은 위 섹션 헤더를 그대로 사용하면 빠르게 정리할 수 있습니다.
